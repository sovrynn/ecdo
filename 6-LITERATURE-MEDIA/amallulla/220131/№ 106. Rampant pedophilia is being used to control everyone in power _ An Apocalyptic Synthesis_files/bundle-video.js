// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-3.0
(()=>{"use strict";var e={d:(t,o)=>{for(var i in o)e.o(o,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:o[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>r});var o=!1;let i={prefix:"/web"};function r(e){var t;o?console.log("already initialized"):(o=!0,"string"==typeof e?i={prefix:e}:Object.assign(i,e),(t=a)(),setInterval(t,n))}var n=1e3;function a(){var e=s.length;!function(){var e=document.location.href.match(/\/embed\/([-_a-zA-Z0-9]{11})/);if(e)console.log("this is a embed for %s",e[1]),f("#player",(()=>({vid:e[1]})));else{f("div#flashcontent"),f("div#playerDiv > div#movie_player"),f("div#watch-player.flash-player"),f("div#watch7-player.flash-player");document.querySelector("ytd-app")?f("ytd-app ytd-watch-flexy ytd-player")||f("ytd-app ytd-player:not(.ytd-video-preview)"):f("#player:not(.skeleton) #player-api")}}(),e!=s.length&&console.log("players=%o",s);for(const e of s)e.target&&(e.disconnected||(e.target.isConnected?e.discoverVideoInfo():(console.log("%o: node %s was removed from DOM",e,e.target),e.disconnected=!0)))}const l=[null,null,"The requested video has been archived but is not currently available for playback.","We have not been able to archive the video associated with this YouTube page.",null,null,"The Wayback Machine does not have this video archived."];class d{constructor(e,t){this.target=e,t&&(this.vinfo=t)}playerNode(){var e=this.target.querySelector("embed#movie_player");if(e)return e;var t=this.target.querySelector("div.html5-video-player");return t||this.target}discoverVideoInfo(){if(!this.vinfo){var e=function(e){for(var t=0;t<p.length;t++){var o=p[t](e);if(o)return console.log("  vid=%s",o.vid),o}return null}(this.target);console.log(e),e&&(this.vinfo=e)}!this.vinfo||this.vinfo.location||this.vinfoFetch||(this.vinfoFetch=this.getCDXVideoInfo().then((()=>{this.replaced||this.replacePlayer()})))}async getCDXVideoInfo(){const e=this.vinfo,t="/__wb/videoinfo?vtype=youtube&vid="+e.vid,o=await fetch(t);if(200==o.status){const t=await o.json();if(t&&null!=t.status_code){e.video_status_code=t.status_code;const o=l[t.status_code];e.video_status=o||"Status of this video is unknown at this time",this.displayError(e.video_status)}else if(t&&void 0!==t.formats)for(const o of t.formats)if("webm"!==o.ext||!y()){e.location="/web/"+o.timestamp+"oe_/"+o.url,e.ptype=o.ext,e.ctype="video/"+o.ext;break}}null==e.location&&await this.getVideoStreamInfo()}async getVideoStreamInfo(){const e=this.vinfo,t=g("yt/"+e.vid),o=await fetch(t,{method:"HEAD"});if(200!=o.status)return console.log("%s -> %s",t,o.status),void 0===e.video_status&&(e.video_status="Sorry, the Wayback Machine does not have this video ("+e.vid+") archived."),void this.displayError(e.video_status);var i=o.headers.get("content-location");e.location=i||t,console.log("vinfo.location=%s",e.location);var r=o.headers.get("content-type");e.ctype=r,r.indexOf("webm")>=0?e.ptype="webm":r.indexOf("flv")>=0?e.ptype="flv":r.indexOf("mp4")>=0?e.ptype="video/mp4":e.ptype="webm"}replacePlayer(){this.vinfo&&this.vinfo.location&&(this.target.origId||"watch-player"==this.target.id||(this.target.origId=this.target.id,this.target.id="--wm--"+(this.target.id||Date.now())),function(e){var t=e.vinfo;if(!t||!t.location)return!1;var o=e.playerNode();if(!o)return!1;e.fullImgUrl=g("yt/img/"+e.vinfo.vid),window.ytplayer&&(window.ytplayer.config={},window.ytplayer.load=function(){});if(h){var i=o.querySelector("video.html5-main-video");if(i)return console.log("replacing src of %o with %s",i,t.location),i.src=t.location,!0}return function(e,t,o,i){jwplayer||console.log("jwplayer is not loaded");if(e.setupInitiated)return;var r=e.playerNode();if(!r)return!1;r.id||(r.id="--wm--"+Date.now());r.parentElement.style.zIndex=1e3;var n=r.clientWidth||"100%",a=r.clientHeight||"100%";if(e.setupInitiated=!0,"flv"==e.vinfo.ptype){function d(){r.style.display="flex",r.style.flexDirection="column";try{const t=document.createElement("video");t.autoplay=!0,t.controls=!0,t.style.width="100%";const o=r.querySelector("embed");o?r.replaceChild(t,o):r.appendChild(t);const i=flvjs.createPlayer({type:"flv",url:e.vinfo.location});i.attachMediaElement(t),i.load()}catch(e){console.log(`error setting up flvjs: ${e}`),r.parentElement.removeChild(r)}}if(console.log("initializing flvjs on %o (vo=%o)",r,e),"undefined"==typeof flvjs){const s=document.createElement("script");s.src=`${__wm.sp()}js/flv.min.js`,s.addEventListener("load",d),document.head.appendChild(s)}else d();return}console.log("initializing jwplayer on %o (vo=%o)",r,e),jwplayer.key="sZbikYlI/xtW0U/3Tw1DOdjC1EahhtUCJF5KggVdqDY=";var l=jwplayer(r);if(!l.setup)return console.log("failed to initialize jwplayer"),!1;return l.setup({height:a,width:n,autostart:o,image:e.fullImgUrl,primary:y()?"flash":"html5",playlist:[{image:e.fullImgUrl,sources:[{file:e.vinfo.location,type:e.vinfo.ptype}]}],events:{onError:i},analytics:{enabled:!1}}),!0}(e,t.ptype,!1)}(this)&&(this.replaced=!0))}displayError(e){const t=this.target;let o=t.querySelector("div#wm-video-error");o||(o=document.createElement("div"),o.id="wm-video-error",o.setAttribute("style","position:absolute;top:0;background:#000000c0;z-index:9999;padding:20px;left:10%;right:10%;text-align:center;height:10%;color:#fff;border-bottom-left-radius:20px;border-bottom-right-radius:20px;border:solid 4px #ffffff;border-top:none;font-size:12pt;"),t.insertBefore(o,t.firstChild)),o.innerHTML=e}}var s=[];function c(e,t){if(e._wm_videoplayer)return!1;var o=new d(e,t);return e._wm_videoplayer=o,e.classList.add("wm-videoplayer"),s.push(o),!0}function f(e,t){t=t||function(){return null};let o=!1;for(let i of document.querySelectorAll(e))c(i,t(i))&&(console.log("player el=%o %o",i,i._wm_videoplayer),o=!0);return o}var v=/\?video_id=([-_a-zA-Z0-9]+)/,u=/\&video_id=([-_a-zA-Z0-9]+)/,p=[function(e){var t=(e.querySelector("video")||e).src;if(console.log("video.src = %s",t),t){var o=t.match(v);if(o)return{vid:o[1]}}return null},function(e){if("EMBED"!=e.tagName&&!(e=e.querySelector("embed")))return null;var t=e.getAttribute("flashvars");if(console.log("attr flashvars = %s",t),t){var o=t.match(u);if(o)return{vid:o[1]}}return null},function(e){var t=e.querySelector("div.ytp-cued-thumbnail-overlay-image");if(console.log("thumbnail = %o",t),t){var o=window.getComputedStyle(t).backgroundImage;if(o){var i=o.match(/\/vi\/([-_a-zA-Z0-9]+)\/hqdefault/);if(i)return{vid:i[1]}}}return null},function(e){var t=function(e,t){var o=e.parentElement;for(;o&&o!=document.body;){if(o.tagName==t)return o;o=o.parentElement}return null}(e,"YTD-WATCH-FLEXY");if(console.log("ytd-watch-flexy = %o",t),t){var o=t.getAttribute("video-id");if(t.hasAttribute("player-unavailable")){t.removeAttribute("player-unavailable");var i=t.querySelector("#error-screen");i?i.parentElement.removeChild(i):console.log("#error-screen element is not found")}if(o)return{vid:o}}return null},function(e){var t=document.querySelector('div#content meta[itemprop="videoId"]');if(console.log('div#content meta[itemprop="vidoId"] = %o',t),t){var o=t.getAttribute("content");if(o)return{vid:o}}return null},function(e){let t=document.querySelector('div#watch7-content meta[itemprop="videoId"]');if(console.log('div#watch7-content meta[itemprop="videoId"] = %o',t),t){const e=t.content;if(e)return{vid:e}}return null},function(e){if("undefined"!=typeof ytplayer&&ytplayer.config&&ytplayer.config.args){var t=ytplayer.config.args.video_id;if(t)return{vid:t}}}];function y(){return-1!=navigator.userAgent.indexOf("Safari")&&-1!=navigator.userAgent.indexOf("Mac")&&-1==navigator.userAgent.indexOf("Chrome")}const h=!1;function g(e){return`${i.prefix}/2oe_/http://wayback-fakeurl.archive.org/${e}`}window._wmVideos_=t})();
// @license-end
